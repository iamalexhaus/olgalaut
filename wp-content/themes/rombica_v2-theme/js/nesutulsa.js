var $body,header_height,$window=$(window),$document=$(document),mp="(max-width: 767px) and (orientation: portrait)",ml="(max-width: 812px) and (orientation: landscape)";function whichTransitionEvent(){var e=document.createElement("fake"),i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",transition:"transitionend"};for(var t in i)if(void 0!==e.style[t])return i[t]}function whichAnimationEvent(){var e,i=document.createElement("fakeelement"),t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(e in t)if(void 0!==i.style[e])return t[e]}var animationEvent=whichAnimationEvent(),transEndEventName=whichTransitionEvent(),aaffReadyTouch={init:function(){navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|iemobile|Windows Phone)/)&&(aaffIsTouch=!0,$body.addClass("touch"))}};function init_global_search(){var t=$(".site-search"),e=$(".site-header__search"),n=e.children(".site-header__search-open"),s=e.children(".site-header__search-close"),a=$(".site-search__input"),o=$(".site-search__input1"),r=$(".input-label"),d=$(".site-header"),i=($(".site-menu"),$("#global_search_overlay")),l=$("#search_submit"),c=!1;function u(e){return null==e.which?e.keyCode<32?null:String.fromCharCode(e.keyCode):0!=e.which&&0!=e.charCode?e.which<32?null:String.fromCharCode(e.which):null}e.click(function(){if(n.toggleClass("is-hidden"),s.toggleClass("is-hidden"),t.toggleClass("site-search--visible"),r.toggleClass("input-label--visible"),o.toggleClass("site-search__input1--visible"),d.is(".white")&&d.toggleClass("no-boxshadow"),r.is(".hide")&&o.val("").focus(),!c){var e={strings:a.data("strings-desktop").split("|"),typeSpeed:15,startDelay:600},i={strings:a.data("strings-mobile").split("|"),typeSpeed:15,startDelay:600};if($window.width()<=470)new Typed("#site-search",i);else new Typed("#site-search",e)}r.click(function(){r.addClass("hide"),o.focus()}),o.on("focus",function(){l.removeClass("is-hidden")}),o.on("blur",function(){if($(this).val())return!1;l.addClass("is-hidden")}),c=!0}),i.click(function(){n.toggleClass("is-hidden"),s.toggleClass("is-hidden"),t.toggleClass("site-search--visible"),r.toggleClass("input-label--visible"),o.toggleClass("site-search__input1--visible")}),$(document).on("keypress",function e(i){t.is(".site-search--visible")&&u(i)&&($(document).off("keypress",e),r.addClass("hide"),o.focus())})}function init_mobile_menu(){var e=$("#site_menu_mobile"),i=e.find("input");e.find("ul").each(function(){var e=$(this);e.data("height",e.height()),e.css({"max-height":"0",display:"block"})}),i.on("change",function(){var e=$(this),i=e.siblings("ul");e.prop("checked")?i.css("max-height",i.data("height")):i.css("max-height","0")})}function onFormSubmit(e){$(document).trigger("reCaptured",[e])}function sendForm(e){var i=e.recaptchaId,t=e.btn_close;delete e.recaptchaId,delete e.btn_close;var n=document.location.origin+"/custom_endpoint/",s={};for(var a in e)s[a]=e[a];$.post(n,s).done(function(e){1==e?t.trigger("click"):(void 0!==i?grecaptcha.reset(i):grecaptcha.reset(),alert("Отправка форма не удалась! Попробуйте ещё раз или свяжитесь с администратором."))}).fail(function(e){console.log(e.responseText)})}function check_form(e,t,i){var n=$("#"+e),s=[],a={},o={onElementValidate:function(e,i,t,n){e?a[i.attr("name")]=i.val():s.push({el:i,error:n})},errorMessagePosition:"top",validateOnBlur:!1,showHelpOnFocus:!1,addSuggestions:!1,validateHiddenInputs:!1};n.isValid({errorTitle:"Ошибка отправки формы!",requiredField:"Это поле обязательно для заполнения",requiredFields:"Не все поля заполнены",badEmail:"Некорректный email",lengthBadStart:"Номер телефона должен быть длиной ",lengthBadEnd:" цифр"},o,!0)&&($(document).one("reCaptured",function(e,i){a.recaptcha=i,a.form_type=n.data("type"),a.btn_close=t,sendForm(a)}),void 0!==i?(a.recaptchaId=i,grecaptcha.execute(i)):grecaptcha.execute())}$document.ready(function(){$body=$("body"),header_height=$("#site_header").height(),aaffReadyTouch.init();var i=!1;$("body").on({mousewheel:function(e){i&&(e.preventDefault(),e.stopPropagation())}});var s,a,o,t=$(".site-menu__right-side"),r=t.css("background-image");($(".site-header__menu").on("click",function(){$(this).toggleClass("site-header__menu--active"),window.matchMedia(mp).matches||window.matchMedia(ml).matches?$(".site-menu-mobile").toggleClass("is-opened"):($(".site-menu").toggleClass("site-menu--active"),$(".site-header__menu-toggle-label").toggleClass("site-header__menu-toggle-label--active"),$(".site-menu__list--submenu--visible").removeClass("site-menu__list--submenu--visible")),i?(i=!1,$("body").css("overflow-y","auto")):(i=!0,$("body").css("overflow-y","hidden"))}),$body.is(".touch")||$(".site-menu__list:not(.site-menu__list--secondary) a").hover(function(){var n=$(this);if(n.is("[data-menu=root]")){!n.is("[data-bg]")&!n.is("[data-description]")&&t.css("background-image",r);var e=n.next();e.length?($(".site-menu__list--submenu").not(e).removeClass("site-menu__list--submenu--visible"),e.addClass("site-menu__list--submenu--visible")):$(".site-menu__list--submenu").removeClass("site-menu__list--submenu--visible")}n.is("[data-description]")?function(e){s=n.data("description");var i=$(".site-menu__description[data-description="+s+"]");e&&i.css("background",e);a=i.find(".site-menu__description-content");var t=$(".site-menu__description-title");o=i.find(".site-menu__description-content-concealer"),i.addClass("visible"),i.one(transEndEventName,function(){var e=t.outerHeight(!0);o.animate({top:e},1e3,function(){a.addClass("centered").one(transEndEventName,function(){o.animate({top:"+="+t.next().outerHeight()},1400,function(){o.animate({top:"+="+t.next().next().outerHeight(!0)},1400)})})})})}():n.is("[data-bg]")&&t.css("background-image","url("+n.attr("data-bg")+")")},function(){var e=$(this);e.is("[data-description="+s+"]")&&($(".site-menu__description").removeClass("visible"),a.removeClass("centered"),o.stop().css("top","0"))}),$(".site-header__search").on("click",function(){$window.width()<544&&$(".site-header__menu").is(".site-header__menu--active")&&$(".l-search-mobile").toggleClass("l-search-mobile--active")}),$body.is(".touch"))&&$("[data-menu=root]").click(function(e){var i=$(this);i.next().length&&(e.preventDefault(),i.next().toggleClass("site-menu__list--submenu--visible"),i.toggleClass("pressed"))})}),$(function(){init_global_search(),init_mobile_menu()});